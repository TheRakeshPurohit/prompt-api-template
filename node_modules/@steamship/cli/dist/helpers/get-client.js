import { CliUx } from '@oclif/core';
import { loadConfiguration, Steamship, User } from '@steamship/client';
import { doLogin, isLoggedIn } from '../wizards/login.js';
export async function getAuthedClient() {
    let config = {};
    try {
        config = await loadConfiguration();
    }
    catch {
    }
    if (!isLoggedIn(config)) {
        await doLogin({ config });
    }
    const client = new Steamship();
    await client.config;
    try {
        const user = await User.current(client);
    }
    catch (e) {
        CliUx.ux.error(e.message);
    }
    return client;
}

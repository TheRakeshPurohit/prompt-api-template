import { CliUx, Command, Flags } from '@oclif/core';
import { getConfiguration } from '../wizards/get-config.js';
import * as UpdatePackage from './package/update.js';
import * as UpdatePlugin from './plugin/update.js';
export default class Deploy extends Command {
    static description = "Updates a Steamship Package or Plugin from a project's root folder.";
    static examples = [`$ ship update`];
    static flags = {
        help: Flags.help({ char: 'h' })
    };
    static args = [];
    updatePackage;
    updatePlugin;
    constructor(argv, config) {
        super(argv, config);
        this.updatePackage = new UpdatePackage.default(argv, config);
        this.updatePlugin = new UpdatePlugin.default(argv, config);
    }
    async run() {
        const config = await getConfiguration({});
        if (!config) {
            CliUx.ux.error('Please run `ship update` from a folder containing an Package or Plugin project');
        }
        if (config.type == 'package') {
            CliUx.ux.info('Invoking `ship package:update');
            this.updatePackage.run();
        }
        else if (config.type == 'plugin') {
            CliUx.ux.info('Invoking `ship plugin:update');
            this.updatePlugin.run();
        }
        else {
            CliUx.ux.error(`Your steamship.json file had a \`type\` field of \`${config.type}\`. Either \`app\` or \`plugin\` are required to run \`ship update\``);
        }
    }
}

import { CliUx, Command, Flags } from '@oclif/core';
import { getConfiguration } from '../wizards/get-config.js';
import * as DeployPackage from './package/deploy.js';
import * as DeployPlugin from './plugin/deploy.js';
export default class Deploy extends Command {
    static description = "Deploys a Steamship Package or Plugin from a project's root folder.";
    static examples = [`$ ship deploy`];
    static flags = {
        help: Flags.help({ char: 'h' })
    };
    static args = [];
    deployPackage;
    deployPlugin;
    constructor(argv, config) {
        super(argv, config);
        this.deployPackage = new DeployPackage.default(argv, config);
        this.deployPlugin = new DeployPlugin.default(argv, config);
    }
    async run() {
        const config = await getConfiguration({});
        if (!config) {
            CliUx.ux.error('Please run `ship deploy` from a folder containing an Package or Plugin project');
        }
        if (config.type == 'package') {
            this.deployPackage.run();
        }
        else if (config.type == 'plugin') {
            this.deployPlugin.run();
        }
        else {
            CliUx.ux.error(`Your steamship.json file had a \`type\` field of \`${config.type}\`. Either \`app\` or \`plugin\` are required to run \`ship deploy\``);
        }
    }
}
